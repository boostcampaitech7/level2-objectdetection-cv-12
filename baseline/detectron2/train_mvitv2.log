nohup: ignoring input
[10/20 02:41:34 detectron2]: Rank of current process: 0. World size: 1
Rank of current process: 0. World size: 1
[10/20 02:41:34 detectron2]: Rank of current process: 0. World size: 1
[10/20 02:41:35 detectron2]: Environment info:
-------------------------------  -----------------------------------------------------------------
sys.platform                     linux
Python                           3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
numpy                            1.22.4
detectron2                       0.6 @/data/ephemeral/home/bigstar/baseline/detectron2/detectron2
Compiler                         GCC 9.4
CUDA compiler                    not available
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          1.12.1+cu116 @/opt/conda/lib/python3.10/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            Tesla V100-SXM2-32GB (arch=7.0)
Driver version                   535.161.08
CUDA_HOME                        None - invalid!
Pillow                           9.4.0
torchvision                      0.13.1+cu116 @/opt/conda/lib/python3.10/site-packages/torchvision
torchvision arch flags           /opt/conda/lib/python3.10/site-packages/torchvision/_C.so
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.8.1
-------------------------------  -----------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.6
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.3.2  (built against CUDA 11.5)
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.6, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.12.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

Environment info:
-------------------------------  -----------------------------------------------------------------
sys.platform                     linux
Python                           3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
numpy                            1.22.4
detectron2                       0.6 @/data/ephemeral/home/bigstar/baseline/detectron2/detectron2
Compiler                         GCC 9.4
CUDA compiler                    not available
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          1.12.1+cu116 @/opt/conda/lib/python3.10/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            Tesla V100-SXM2-32GB (arch=7.0)
Driver version                   535.161.08
CUDA_HOME                        None - invalid!
Pillow                           9.4.0
torchvision                      0.13.1+cu116 @/opt/conda/lib/python3.10/site-packages/torchvision
torchvision arch flags           /opt/conda/lib/python3.10/site-packages/torchvision/_C.so
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.8.1
-------------------------------  -----------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.6
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.3.2  (built against CUDA 11.5)
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.6, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.12.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[10/20 02:41:35 detectron2]: Environment info:
-------------------------------  -----------------------------------------------------------------
sys.platform                     linux
Python                           3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
numpy                            1.22.4
detectron2                       0.6 @/data/ephemeral/home/bigstar/baseline/detectron2/detectron2
Compiler                         GCC 9.4
CUDA compiler                    not available
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          1.12.1+cu116 @/opt/conda/lib/python3.10/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            Tesla V100-SXM2-32GB (arch=7.0)
Driver version                   535.161.08
CUDA_HOME                        None - invalid!
Pillow                           9.4.0
torchvision                      0.13.1+cu116 @/opt/conda/lib/python3.10/site-packages/torchvision
torchvision arch flags           /opt/conda/lib/python3.10/site-packages/torchvision/_C.so
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.8.1
-------------------------------  -----------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.6
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.3.2  (built against CUDA 11.5)
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.6, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.12.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[10/20 02:41:35 detectron2]: Command line arguments: Namespace(config_file='/data/ephemeral/home/bigstar/baseline/detectron2/projects/MViTv2/configs/cascade_mask_rcnn_mvitv2_h_in21k_lsj_3x.py', resume=False, eval_only=False, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49152', opts=[])
Command line arguments: Namespace(config_file='/data/ephemeral/home/bigstar/baseline/detectron2/projects/MViTv2/configs/cascade_mask_rcnn_mvitv2_h_in21k_lsj_3x.py', resume=False, eval_only=False, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49152', opts=[])
[10/20 02:41:35 detectron2]: Command line arguments: Namespace(config_file='/data/ephemeral/home/bigstar/baseline/detectron2/projects/MViTv2/configs/cascade_mask_rcnn_mvitv2_h_in21k_lsj_3x.py', resume=False, eval_only=False, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:49152', opts=[])
[10/20 02:41:35 detectron2]: Contents of args.config_file=/data/ephemeral/home/bigstar/baseline/detectron2/projects/MViTv2/configs/cascade_mask_rcnn_mvitv2_h_in21k_lsj_3x.py:
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcascade_mask_rcnn_mvitv2_b_3x[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15moptimizer[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mtrain[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mlr_multiplier[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mcoco_loader_lsj[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mdataloader[39m


[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15membed_dim[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m192[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mdepth[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m80[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mnum_heads[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m3[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mlast_block_indexes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m([39m[38;5;141m3[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m11[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m71[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m79[39m[38;5;15m)[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mdrop_path_rate[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m0.6[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15muse_act_checkpoint[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;81mTrue[39m

[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15minit_checkpoint[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mdetectron2://ImageNetPretrained/mvitv2/MViTv2_H_in21k.pyth[39m[38;5;186m"[39m


[38;5;242m# trash image data에 맞게 클래스 개수 수정[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;197m.[39m[38;5;15mnum_classes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m10[39m

[38;5;242m# 데이터셋 등록[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mdatasets[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mregister_coco_instances[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mDatasetCatalog[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mMetadataCatalog[39m

[38;5;15mn_splits[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m5[39m

[38;5;81mfor[39m[38;5;15m [39m[38;5;15mfold_idx[39m[38;5;15m [39m[38;5;197min[39m[38;5;15m [39m[38;5;15mrange[39m[38;5;15m([39m[38;5;15mn_splits[39m[38;5;15m)[39m[38;5;15m:[39m
[38;5;15m    [39m[38;5;242m# Register Dataset[39m
[38;5;15m    [39m[38;5;81mtry[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;242m# train_fold_{fold_idx}.json 파일을 등록하는 부분에서 f-string을 사용하여 경로를 올바르게 설정[39m
[38;5;15m        [39m[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m.json[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/[39m[38;5;186m'[39m[38;5;15m)[39m
[38;5;15m    [39m[38;5;81mexcept[39m[38;5;15m [39m[38;5;148mAssertionError[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;81mpass[39m

[38;5;15m    [39m[38;5;81mtry[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;242m# val_fold_{fold_idx}.json 파일을 등록하는 부분에서도 f-string을 사용하여 경로를 올바르게 설정[39m
[38;5;15m        [39m[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m.json[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/[39m[38;5;186m'[39m[38;5;15m)[39m
[38;5;15m    [39m[38;5;81mexcept[39m[38;5;15m [39m[38;5;148mAssertionError[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;81mpass[39m

[38;5;242m# MetadataCatalog는 메타데이터를 설정[39m
[38;5;15mMetadataCatalog[39m[38;5;197m.[39m[38;5;15mget[39m[38;5;15m([39m[38;5;186m'[39m[38;5;186mcoco_trash_train[39m[38;5;186m'[39m[38;5;15m)[39m[38;5;197m.[39m[38;5;15mthing_classes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m[[39m[38;5;186m"[39m[38;5;186mGeneral trash[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPaper[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPaper pack[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mMetal[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                                         [39m[38;5;186m"[39m[38;5;186mGlass[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPlastic[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mStyrofoam[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPlastic bag[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mBattery[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mClothing[39m[38;5;186m"[39m[38;5;15m][39m

[38;5;242m# 0부터 4까지 가능, 사용하고자 하는 폴드를 설정[39m
[38;5;15mfold_idx[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m0[39m

[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mdataset[39m[38;5;197m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtest[39m[38;5;197m.[39m[38;5;15mdataset[39m[38;5;197m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m

[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmapper[39m[38;5;197m.[39m[38;5;15muse_instance_mask[39m[38;5;197m=[39m[38;5;81mFalse[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmapper[39m[38;5;197m.[39m[38;5;15mrecompute_boxes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;81mFalse[39m



[38;5;242m# 훈련 이터레이션 수 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmax_iter[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m20000[39m

[38;5;242m# 체크포인트 저장 주기 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mcheckpointer[39m[38;5;197m.[39m[38;5;15mperiod[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m5000[39m

[38;5;242m# 테스트 주기 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15meval_period[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m500[39m

[38;5;242m# 필요에 따라 학습률 스케줄러 조정[39m
[38;5;15mlr_multiplier[39m[38;5;197m.[39m[38;5;15mscheduler[39m[38;5;197m.[39m[38;5;15mmilestones[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m[[39m[38;5;141m1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m10000[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m15000[39m[38;5;15m][39m
[38;5;15mlr_multiplier[39m[38;5;197m.[39m[38;5;15mscheduler[39m[38;5;197m.[39m[38;5;15mvalues[39m[38;5;197m=[39m[38;5;15m[[39m[38;5;141m1.0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.01[39m[38;5;15m][39m

[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_in_features[39m[38;5;186m'[39m[38;5;15m][39m
[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_pooler[39m[38;5;186m'[39m[38;5;15m][39m
[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_head[39m[38;5;186m'[39m[38;5;15m][39m

[38;5;242m### batch size[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mtotal_batch_size[39m[38;5;197m=[39m[38;5;141m4[39m

Contents of args.config_file=/data/ephemeral/home/bigstar/baseline/detectron2/projects/MViTv2/configs/cascade_mask_rcnn_mvitv2_h_in21k_lsj_3x.py:
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcascade_mask_rcnn_mvitv2_b_3x[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15moptimizer[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mtrain[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mlr_multiplier[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mcoco_loader_lsj[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mdataloader[39m


[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15membed_dim[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m192[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mdepth[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m80[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mnum_heads[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m3[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mlast_block_indexes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m([39m[38;5;141m3[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m11[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m71[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m79[39m[38;5;15m)[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mdrop_path_rate[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m0.6[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15muse_act_checkpoint[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;81mTrue[39m

[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15minit_checkpoint[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mdetectron2://ImageNetPretrained/mvitv2/MViTv2_H_in21k.pyth[39m[38;5;186m"[39m


[38;5;242m# trash image data에 맞게 클래스 개수 수정[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;197m.[39m[38;5;15mnum_classes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m10[39m

[38;5;242m# 데이터셋 등록[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mdatasets[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mregister_coco_instances[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mDatasetCatalog[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mMetadataCatalog[39m

[38;5;15mn_splits[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m5[39m

[38;5;81mfor[39m[38;5;15m [39m[38;5;15mfold_idx[39m[38;5;15m [39m[38;5;197min[39m[38;5;15m [39m[38;5;15mrange[39m[38;5;15m([39m[38;5;15mn_splits[39m[38;5;15m)[39m[38;5;15m:[39m
[38;5;15m    [39m[38;5;242m# Register Dataset[39m
[38;5;15m    [39m[38;5;81mtry[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;242m# train_fold_{fold_idx}.json 파일을 등록하는 부분에서 f-string을 사용하여 경로를 올바르게 설정[39m
[38;5;15m        [39m[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m.json[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/[39m[38;5;186m'[39m[38;5;15m)[39m
[38;5;15m    [39m[38;5;81mexcept[39m[38;5;15m [39m[38;5;148mAssertionError[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;81mpass[39m

[38;5;15m    [39m[38;5;81mtry[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;242m# val_fold_{fold_idx}.json 파일을 등록하는 부분에서도 f-string을 사용하여 경로를 올바르게 설정[39m
[38;5;15m        [39m[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m.json[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/[39m[38;5;186m'[39m[38;5;15m)[39m
[38;5;15m    [39m[38;5;81mexcept[39m[38;5;15m [39m[38;5;148mAssertionError[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;81mpass[39m

[38;5;242m# MetadataCatalog는 메타데이터를 설정[39m
[38;5;15mMetadataCatalog[39m[38;5;197m.[39m[38;5;15mget[39m[38;5;15m([39m[38;5;186m'[39m[38;5;186mcoco_trash_train[39m[38;5;186m'[39m[38;5;15m)[39m[38;5;197m.[39m[38;5;15mthing_classes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m[[39m[38;5;186m"[39m[38;5;186mGeneral trash[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPaper[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPaper pack[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mMetal[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                                         [39m[38;5;186m"[39m[38;5;186mGlass[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPlastic[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mStyrofoam[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPlastic bag[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mBattery[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mClothing[39m[38;5;186m"[39m[38;5;15m][39m

[38;5;242m# 0부터 4까지 가능, 사용하고자 하는 폴드를 설정[39m
[38;5;15mfold_idx[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m0[39m

[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mdataset[39m[38;5;197m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtest[39m[38;5;197m.[39m[38;5;15mdataset[39m[38;5;197m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m

[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmapper[39m[38;5;197m.[39m[38;5;15muse_instance_mask[39m[38;5;197m=[39m[38;5;81mFalse[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmapper[39m[38;5;197m.[39m[38;5;15mrecompute_boxes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;81mFalse[39m



[38;5;242m# 훈련 이터레이션 수 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmax_iter[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m20000[39m

[38;5;242m# 체크포인트 저장 주기 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mcheckpointer[39m[38;5;197m.[39m[38;5;15mperiod[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m5000[39m

[38;5;242m# 테스트 주기 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15meval_period[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m500[39m

[38;5;242m# 필요에 따라 학습률 스케줄러 조정[39m
[38;5;15mlr_multiplier[39m[38;5;197m.[39m[38;5;15mscheduler[39m[38;5;197m.[39m[38;5;15mmilestones[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m[[39m[38;5;141m1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m10000[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m15000[39m[38;5;15m][39m
[38;5;15mlr_multiplier[39m[38;5;197m.[39m[38;5;15mscheduler[39m[38;5;197m.[39m[38;5;15mvalues[39m[38;5;197m=[39m[38;5;15m[[39m[38;5;141m1.0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.01[39m[38;5;15m][39m

[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_in_features[39m[38;5;186m'[39m[38;5;15m][39m
[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_pooler[39m[38;5;186m'[39m[38;5;15m][39m
[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_head[39m[38;5;186m'[39m[38;5;15m][39m

[38;5;242m### batch size[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mtotal_batch_size[39m[38;5;197m=[39m[38;5;141m4[39m

[10/20 02:41:35 detectron2]: Contents of args.config_file=/data/ephemeral/home/bigstar/baseline/detectron2/projects/MViTv2/configs/cascade_mask_rcnn_mvitv2_h_in21k_lsj_3x.py:
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcascade_mask_rcnn_mvitv2_b_3x[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15moptimizer[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mtrain[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mlr_multiplier[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mcoco_loader_lsj[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mdataloader[39m


[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15membed_dim[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m192[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mdepth[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m80[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mnum_heads[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m3[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mlast_block_indexes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m([39m[38;5;141m3[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m11[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m71[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m79[39m[38;5;15m)[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15mdrop_path_rate[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m0.6[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mbackbone[39m[38;5;197m.[39m[38;5;15mbottom_up[39m[38;5;197m.[39m[38;5;15muse_act_checkpoint[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;81mTrue[39m

[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15minit_checkpoint[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mdetectron2://ImageNetPretrained/mvitv2/MViTv2_H_in21k.pyth[39m[38;5;186m"[39m


[38;5;242m# trash image data에 맞게 클래스 개수 수정[39m
[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;197m.[39m[38;5;15mnum_classes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m10[39m

[38;5;242m# 데이터셋 등록[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mdatasets[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mregister_coco_instances[39m
[38;5;197mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m [39m[38;5;197mimport[39m[38;5;15m [39m[38;5;15mDatasetCatalog[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mMetadataCatalog[39m

[38;5;15mn_splits[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m5[39m

[38;5;81mfor[39m[38;5;15m [39m[38;5;15mfold_idx[39m[38;5;15m [39m[38;5;197min[39m[38;5;15m [39m[38;5;15mrange[39m[38;5;15m([39m[38;5;15mn_splits[39m[38;5;15m)[39m[38;5;15m:[39m
[38;5;15m    [39m[38;5;242m# Register Dataset[39m
[38;5;15m    [39m[38;5;81mtry[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;242m# train_fold_{fold_idx}.json 파일을 등록하는 부분에서 f-string을 사용하여 경로를 올바르게 설정[39m
[38;5;15m        [39m[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m.json[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/[39m[38;5;186m'[39m[38;5;15m)[39m
[38;5;15m    [39m[38;5;81mexcept[39m[38;5;15m [39m[38;5;148mAssertionError[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;81mpass[39m

[38;5;15m    [39m[38;5;81mtry[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;242m# val_fold_{fold_idx}.json 파일을 등록하는 부분에서도 f-string을 사용하여 경로를 올바르게 설정[39m
[38;5;15m        [39m[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m.json[39m[38;5;186m'[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/data/ephemeral/home/dataset/[39m[38;5;186m'[39m[38;5;15m)[39m
[38;5;15m    [39m[38;5;81mexcept[39m[38;5;15m [39m[38;5;148mAssertionError[39m[38;5;15m:[39m
[38;5;15m        [39m[38;5;81mpass[39m

[38;5;242m# MetadataCatalog는 메타데이터를 설정[39m
[38;5;15mMetadataCatalog[39m[38;5;197m.[39m[38;5;15mget[39m[38;5;15m([39m[38;5;186m'[39m[38;5;186mcoco_trash_train[39m[38;5;186m'[39m[38;5;15m)[39m[38;5;197m.[39m[38;5;15mthing_classes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m[[39m[38;5;186m"[39m[38;5;186mGeneral trash[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPaper[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPaper pack[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mMetal[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                                         [39m[38;5;186m"[39m[38;5;186mGlass[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPlastic[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mStyrofoam[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mPlastic bag[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mBattery[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mClothing[39m[38;5;186m"[39m[38;5;15m][39m

[38;5;242m# 0부터 4까지 가능, 사용하고자 하는 폴드를 설정[39m
[38;5;15mfold_idx[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m0[39m

[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mdataset[39m[38;5;197m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_train_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtest[39m[38;5;197m.[39m[38;5;15mdataset[39m[38;5;197m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;186mf[39m[38;5;186m'[39m[38;5;186mcoco_trash_val_fold_[39m[38;5;186m{[39m[38;5;15mfold_idx[39m[38;5;186m}[39m[38;5;186m'[39m

[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmapper[39m[38;5;197m.[39m[38;5;15muse_instance_mask[39m[38;5;197m=[39m[38;5;81mFalse[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmapper[39m[38;5;197m.[39m[38;5;15mrecompute_boxes[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;81mFalse[39m



[38;5;242m# 훈련 이터레이션 수 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mmax_iter[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m20000[39m

[38;5;242m# 체크포인트 저장 주기 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mcheckpointer[39m[38;5;197m.[39m[38;5;15mperiod[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m5000[39m

[38;5;242m# 테스트 주기 설정[39m
[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15meval_period[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;141m500[39m

[38;5;242m# 필요에 따라 학습률 스케줄러 조정[39m
[38;5;15mlr_multiplier[39m[38;5;197m.[39m[38;5;15mscheduler[39m[38;5;197m.[39m[38;5;15mmilestones[39m[38;5;15m [39m[38;5;197m=[39m[38;5;15m [39m[38;5;15m[[39m[38;5;141m1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m10000[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m15000[39m[38;5;15m][39m
[38;5;15mlr_multiplier[39m[38;5;197m.[39m[38;5;15mscheduler[39m[38;5;197m.[39m[38;5;15mvalues[39m[38;5;197m=[39m[38;5;15m[[39m[38;5;141m1.0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.01[39m[38;5;15m][39m

[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_in_features[39m[38;5;186m'[39m[38;5;15m][39m
[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_pooler[39m[38;5;186m'[39m[38;5;15m][39m
[38;5;81mdel[39m[38;5;15m [39m[38;5;15mmodel[39m[38;5;197m.[39m[38;5;15mroi_heads[39m[38;5;15m[[39m[38;5;186m'[39m[38;5;186mmask_head[39m[38;5;186m'[39m[38;5;15m][39m

[38;5;242m### batch size[39m
[38;5;15mdataloader[39m[38;5;197m.[39m[38;5;15mtrain[39m[38;5;197m.[39m[38;5;15mtotal_batch_size[39m[38;5;197m=[39m[38;5;141m4[39m

WARNING [10/20 02:41:35 d2.config.lazy]: The config contains objects that cannot serialize to a valid yaml. ./output/config.yaml is human-readable but cannot be loaded.
The config contains objects that cannot serialize to a valid yaml. ./output/config.yaml is human-readable but cannot be loaded.
WARNING [10/20 02:41:35 d2.config.lazy]: The config contains objects that cannot serialize to a valid yaml. ./output/config.yaml is human-readable but cannot be loaded.
WARNING [10/20 02:41:35 d2.config.lazy]: Config is saved using cloudpickle at ./output/config.yaml.pkl.
Config is saved using cloudpickle at ./output/config.yaml.pkl.
WARNING [10/20 02:41:35 d2.config.lazy]: Config is saved using cloudpickle at ./output/config.yaml.pkl.
[10/20 02:41:35 detectron2]: Full config saved to ./output/config.yaml
Full config saved to ./output/config.yaml
[10/20 02:41:35 detectron2]: Full config saved to ./output/config.yaml
[10/20 02:41:35 d2.utils.env]: Using a generated random seed 36387332
Using a generated random seed 36387332
[10/20 02:41:35 d2.utils.env]: Using a generated random seed 36387332
[10/20 02:41:51 d2.data.datasets.coco]: Loaded 3908 images in COCO format from /data/ephemeral/home/dataset/train_fold_0.json
Loaded 3908 images in COCO format from /data/ephemeral/home/dataset/train_fold_0.json
[10/20 02:41:51 d2.data.datasets.coco]: Loaded 3908 images in COCO format from /data/ephemeral/home/dataset/train_fold_0.json
[10/20 02:41:52 d2.data.build]: Removed 0 images with no usable annotations. 3908 images left.
Removed 0 images with no usable annotations. 3908 images left.
[10/20 02:41:52 d2.data.build]: Removed 0 images with no usable annotations. 3908 images left.
[10/20 02:41:52 d2.data.build]: Distribution of instances among all 10 categories:
|   category    | #instances   |  category   | #instances   |  category  | #instances   |
|:-------------:|:-------------|:-----------:|:-------------|:----------:|:-------------|
| General trash | 3287         |    Paper    | 5169         | Paper pack | 707          |
|     Metal     | 739          |    Glass    | 824          |  Plastic   | 2344         |
|   Styrofoam   | 1023         | Plastic bag | 4245         |  Battery   | 131          |
|   Clothing    | 339          |             |              |            |              |
|     total     | 18808        |             |              |            |              |
Distribution of instances among all 10 categories:
|   category    | #instances   |  category   | #instances   |  category  | #instances   |
|:-------------:|:-------------|:-----------:|:-------------|:----------:|:-------------|
| General trash | 3287         |    Paper    | 5169         | Paper pack | 707          |
|     Metal     | 739          |    Glass    | 824          |  Plastic   | 2344         |
|   Styrofoam   | 1023         | Plastic bag | 4245         |  Battery   | 131          |
|   Clothing    | 339          |             |              |            |              |
|     total     | 18808        |             |              |            |              |
[10/20 02:41:52 d2.data.build]: Distribution of instances among all 10 categories:
|   category    | #instances   |  category   | #instances   |  category  | #instances   |
|:-------------:|:-------------|:-----------:|:-------------|:----------:|:-------------|
| General trash | 3287         |    Paper    | 5169         | Paper pack | 707          |
|     Metal     | 739          |    Glass    | 824          |  Plastic   | 2344         |
|   Styrofoam   | 1023         | Plastic bag | 4245         |  Battery   | 131          |
|   Clothing    | 339          |             |              |            |              |
|     total     | 18808        |             |              |            |              |
[10/20 02:41:52 d2.data.dataset_mapper]: [DatasetMapper] Augmentations used in training: [RandomFlip(), ResizeScale(min_scale=0.1, max_scale=2.0, target_height=1024, target_width=1024), FixedSizeCrop(crop_size=[1024, 1024])]
[DatasetMapper] Augmentations used in training: [RandomFlip(), ResizeScale(min_scale=0.1, max_scale=2.0, target_height=1024, target_width=1024), FixedSizeCrop(crop_size=[1024, 1024])]
[10/20 02:41:52 d2.data.dataset_mapper]: [DatasetMapper] Augmentations used in training: [RandomFlip(), ResizeScale(min_scale=0.1, max_scale=2.0, target_height=1024, target_width=1024), FixedSizeCrop(crop_size=[1024, 1024])]
[10/20 02:41:52 d2.data.common]: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 02:41:52 d2.data.common]: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 02:41:52 d2.data.common]: Serializing 3908 elements to byte tensors and concatenating them all ...
Serializing 3908 elements to byte tensors and concatenating them all ...
[10/20 02:41:52 d2.data.common]: Serializing 3908 elements to byte tensors and concatenating them all ...
[10/20 02:41:52 d2.data.common]: Serialized dataset takes 1.82 MiB
Serialized dataset takes 1.82 MiB
[10/20 02:41:52 d2.data.common]: Serialized dataset takes 1.82 MiB
[10/20 02:41:52 d2.data.build]: Making batched data loader with batch_size=4
Making batched data loader with batch_size=4
[10/20 02:41:52 d2.data.build]: Making batched data loader with batch_size=4
[10/20 02:41:52 d2.checkpoint.detection_checkpoint]: [DetectionCheckpointer] Loading from detectron2://ImageNetPretrained/mvitv2/MViTv2_H_in21k.pyth ...
[DetectionCheckpointer] Loading from detectron2://ImageNetPretrained/mvitv2/MViTv2_H_in21k.pyth ...
[10/20 02:41:52 d2.checkpoint.detection_checkpoint]: [DetectionCheckpointer] Loading from detectron2://ImageNetPretrained/mvitv2/MViTv2_H_in21k.pyth ...
[10/20 02:41:52 fvcore.common.checkpoint]: [Checkpointer] Loading from /data/ephemeral/home/.torch/iopath_cache/detectron2/ImageNetPretrained/mvitv2/MViTv2_H_in21k.pyth ...
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv1.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv1.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv1.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv1.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv1.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv1.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv2.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv2.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv2.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv2.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv2.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv2.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv3.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv3.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv3.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv3.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv3.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv3.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv4.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv4.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv4.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv4.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv4.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.0.conv4.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv1.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv1.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv1.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv1.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv1.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv1.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv2.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv2.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv2.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv2.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv2.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv2.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv3.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv3.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv3.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv3.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv3.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv3.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv4.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv4.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv4.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv4.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv4.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.1.conv4.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv1.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv1.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv1.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv1.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv1.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv1.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv2.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv2.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv2.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv2.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv2.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv2.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv3.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv3.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv3.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv3.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv3.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv3.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv4.norm.bias in model is torch.Size([256]).
Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv4.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.bias in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv4.norm.bias in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.bias will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv4.norm.weight in model is torch.Size([256]).
Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv4.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: Shape of norm.weight in checkpoint is torch.Size([1536]), while shape of roi_heads.box_head.2.conv4.norm.weight in model is torch.Size([256]).
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
norm.weight will not be loaded. Please double check and see if this is desired.
WARNING [10/20 02:41:59 d2.checkpoint.c2_model_loading]: norm.weight will not be loaded. Please double check and see if this is desired.
[10/20 02:41:59 d2.checkpoint.c2_model_loading]: Following weights matched with submodule backbone.bottom_up - Total num: 404
Following weights matched with submodule backbone.bottom_up - Total num: 404
[10/20 02:41:59 d2.checkpoint.c2_model_loading]: Following weights matched with submodule backbone.bottom_up - Total num: 404
WARNING [10/20 02:42:01 fvcore.common.checkpoint]: Some model parameters or buffers are not found in the checkpoint:
backbone.bottom_up.scale2_norm.{bias, weight}
backbone.bottom_up.scale3_norm.{bias, weight}
backbone.bottom_up.scale4_norm.{bias, weight}
backbone.bottom_up.scale5_norm.{bias, weight}
backbone.fpn_lateral2.{bias, weight}
backbone.fpn_lateral3.{bias, weight}
backbone.fpn_lateral4.{bias, weight}
backbone.fpn_lateral5.{bias, weight}
backbone.fpn_output2.{bias, weight}
backbone.fpn_output3.{bias, weight}
backbone.fpn_output4.{bias, weight}
backbone.fpn_output5.{bias, weight}
proposal_generator.rpn_head.anchor_deltas.{bias, weight}
proposal_generator.rpn_head.conv.conv0.{bias, weight}
proposal_generator.rpn_head.conv.conv1.{bias, weight}
proposal_generator.rpn_head.objectness_logits.{bias, weight}
roi_heads.box_head.0.conv1.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.0.conv1.weight
roi_heads.box_head.0.conv2.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.0.conv2.weight
roi_heads.box_head.0.conv3.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.0.conv3.weight
roi_heads.box_head.0.conv4.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.0.conv4.weight
roi_heads.box_head.0.fc1.{bias, weight}
roi_heads.box_head.1.conv1.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.1.conv1.weight
roi_heads.box_head.1.conv2.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.1.conv2.weight
roi_heads.box_head.1.conv3.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.1.conv3.weight
roi_heads.box_head.1.conv4.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.1.conv4.weight
roi_heads.box_head.1.fc1.{bias, weight}
roi_heads.box_head.2.conv1.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.2.conv1.weight
roi_heads.box_head.2.conv2.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.2.conv2.weight
roi_heads.box_head.2.conv3.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.2.conv3.weight
roi_heads.box_head.2.conv4.norm.{bias, running_mean, running_var, weight}
roi_heads.box_head.2.conv4.weight
roi_heads.box_head.2.fc1.{bias, weight}
roi_heads.box_predictor.0.bbox_pred.{bias, weight}
roi_heads.box_predictor.0.cls_score.{bias, weight}
roi_heads.box_predictor.1.bbox_pred.{bias, weight}
roi_heads.box_predictor.1.cls_score.{bias, weight}
roi_heads.box_predictor.2.bbox_pred.{bias, weight}
roi_heads.box_predictor.2.cls_score.{bias, weight}
WARNING [10/20 02:42:01 fvcore.common.checkpoint]: The checkpoint state_dict contains keys that are not used by the model:
  cls_token
  head.projection.{bias, weight}
  norm.{bias, weight}
[10/20 02:42:01 d2.engine.train_loop]: Starting training from iteration 0
Starting training from iteration 0
[10/20 02:42:01 d2.engine.train_loop]: Starting training from iteration 0
/opt/conda/lib/python3.10/site-packages/torch/functional.py:478: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2894.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/opt/conda/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
[10/20 02:43:41 d2.utils.events]:  eta: 1 day, 3:19:52  iter: 19  total_loss: 7.842  loss_cls_stage0: 2.179  loss_box_reg_stage0: 0.001262  loss_cls_stage1: 2.302  loss_box_reg_stage1: 0.001645  loss_cls_stage2: 2.407  loss_box_reg_stage2: 0.002363  loss_rpn_cls: 0.6925  loss_rpn_loc: 0.0855    time: 4.9170  last_time: 4.9377  data_time: 0.0223  last_data_time: 0.0088   lr: 4.223e-06  max_mem: 18670M
 eta: 1 day, 3:19:52  iter: 19  total_loss: 7.842  loss_cls_stage0: 2.179  loss_box_reg_stage0: 0.001262  loss_cls_stage1: 2.302  loss_box_reg_stage1: 0.001645  loss_cls_stage2: 2.407  loss_box_reg_stage2: 0.002363  loss_rpn_cls: 0.6925  loss_rpn_loc: 0.0855    time: 4.9170  last_time: 4.9377  data_time: 0.0223  last_data_time: 0.0088   lr: 4.223e-06  max_mem: 18670M
[10/20 02:43:41 d2.utils.events]:  eta: 1 day, 3:19:52  iter: 19  total_loss: 7.842  loss_cls_stage0: 2.179  loss_box_reg_stage0: 0.001262  loss_cls_stage1: 2.302  loss_box_reg_stage1: 0.001645  loss_cls_stage2: 2.407  loss_box_reg_stage2: 0.002363  loss_rpn_cls: 0.6925  loss_rpn_loc: 0.0855    time: 4.9170  last_time: 4.9377  data_time: 0.0223  last_data_time: 0.0088   lr: 4.223e-06  max_mem: 18670M
[10/20 02:45:20 d2.utils.events]:  eta: 1 day, 3:21:27  iter: 39  total_loss: 3.402  loss_cls_stage0: 0.7663  loss_box_reg_stage0: 0.0204  loss_cls_stage1: 0.7914  loss_box_reg_stage1: 0.01182  loss_cls_stage2: 0.8402  loss_box_reg_stage2: 0.002968  loss_rpn_cls: 0.6528  loss_rpn_loc: 0.1233    time: 4.9278  last_time: 4.9428  data_time: 0.0104  last_data_time: 0.0097   lr: 8.4998e-06  max_mem: 18670M
 eta: 1 day, 3:21:27  iter: 39  total_loss: 3.402  loss_cls_stage0: 0.7663  loss_box_reg_stage0: 0.0204  loss_cls_stage1: 0.7914  loss_box_reg_stage1: 0.01182  loss_cls_stage2: 0.8402  loss_box_reg_stage2: 0.002968  loss_rpn_cls: 0.6528  loss_rpn_loc: 0.1233    time: 4.9278  last_time: 4.9428  data_time: 0.0104  last_data_time: 0.0097   lr: 8.4998e-06  max_mem: 18670M
[10/20 02:45:20 d2.utils.events]:  eta: 1 day, 3:21:27  iter: 39  total_loss: 3.402  loss_cls_stage0: 0.7663  loss_box_reg_stage0: 0.0204  loss_cls_stage1: 0.7914  loss_box_reg_stage1: 0.01182  loss_cls_stage2: 0.8402  loss_box_reg_stage2: 0.002968  loss_rpn_cls: 0.6528  loss_rpn_loc: 0.1233    time: 4.9278  last_time: 4.9428  data_time: 0.0104  last_data_time: 0.0097   lr: 8.4998e-06  max_mem: 18670M
[10/20 02:46:59 d2.utils.events]:  eta: 1 day, 3:22:03  iter: 59  total_loss: 1.351  loss_cls_stage0: 0.2147  loss_box_reg_stage0: 0.07889  loss_cls_stage1: 0.1451  loss_box_reg_stage1: 0.03993  loss_cls_stage2: 0.1378  loss_box_reg_stage2: 0.01361  loss_rpn_cls: 0.4939  loss_rpn_loc: 0.1045    time: 4.9377  last_time: 4.9545  data_time: 0.0102  last_data_time: 0.0133   lr: 1.2777e-05  max_mem: 18670M
 eta: 1 day, 3:22:03  iter: 59  total_loss: 1.351  loss_cls_stage0: 0.2147  loss_box_reg_stage0: 0.07889  loss_cls_stage1: 0.1451  loss_box_reg_stage1: 0.03993  loss_cls_stage2: 0.1378  loss_box_reg_stage2: 0.01361  loss_rpn_cls: 0.4939  loss_rpn_loc: 0.1045    time: 4.9377  last_time: 4.9545  data_time: 0.0102  last_data_time: 0.0133   lr: 1.2777e-05  max_mem: 18670M
[10/20 02:46:59 d2.utils.events]:  eta: 1 day, 3:22:03  iter: 59  total_loss: 1.351  loss_cls_stage0: 0.2147  loss_box_reg_stage0: 0.07889  loss_cls_stage1: 0.1451  loss_box_reg_stage1: 0.03993  loss_cls_stage2: 0.1378  loss_box_reg_stage2: 0.01361  loss_rpn_cls: 0.4939  loss_rpn_loc: 0.1045    time: 4.9377  last_time: 4.9545  data_time: 0.0102  last_data_time: 0.0133   lr: 1.2777e-05  max_mem: 18670M
